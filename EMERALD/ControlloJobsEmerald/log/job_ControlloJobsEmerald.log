2024-10-10 12:54:28,524 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-10 12:54:28,524 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-10 12:54:28,524 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-10 12:54:28,524 - Job_ControlloJobsEmerald - INFO - Query da eseguire: use EMRLCBF1
DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

IF @GiornoDellaSettimana = 2 -- Se oggi è lunedì (2 in SQL Server rappresenta lunedì)
BEGIN
 SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,S.FieldName as JobStatusDesc,J.StartExecTimestamp
FROM 
    [dbo].[JAPJobs] AS J 
INNER JOIN 
    [dbo].[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN Domains S ON S.TextValue=J.JobStatus
WHERE
 S.Field='JobStatus' and
    CAST(J.StartExecTimestamp AS DATE) =@Oggi
UNION ALL
 SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,S.FieldName as JobStatusDesc,J.StartExecTimestamp
FROM 
    [dbo].[JAPJobs] AS J 
INNER JOIN 
    [dbo].[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN Domains S ON S.TextValue=J.JobStatus
WHERE
 S.Field='JobStatus' and    CAST(J.StartExecTimestamp AS DATE) =@Ieri AND J.JobStatus!='V'
UNION ALL
 SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,S.FieldName as JobStatusDesc,J.StartExecTimestamp
FROM 
    [dbo].[JAPJobs] AS J 
INNER JOIN 
    [dbo].[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN Domains S ON S.TextValue=J.JobStatus
WHERE
 S.Field='JobStatus' and    CAST(J.StartExecTimestamp AS DATE) =@AltriIeri AND J.JobStatus!='V'
END
ELSE
BEGIN
 SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,S.FieldName as JobStatusDesc,J.StartExecTimestamp
FROM 
    [dbo].[JAPJobs] AS J 
INNER JOIN 
    [dbo].[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN Domains S ON S.TextValue=J.JobStatus
WHERE
 S.Field='JobStatus' and 
    CAST(J.StartExecTimestamp AS DATE) =@Oggi
UNION ALL
 SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,S.FieldName as JobStatusDesc,J.StartExecTimestamp
FROM 
    [dbo].[JAPJobs] AS J 
INNER JOIN 
    [dbo].[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN Domains S ON S.TextValue=J.JobStatus
WHERE
 S.Field='JobStatus' and    CAST(J.StartExecTimestamp AS DATE) =@Ieri  AND J.JobStatus!='V'
END
2024-10-10 12:54:28,682 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-10 12:54:28,745 - Job_ControlloJobsEmerald - ERROR - Errore durante l'esecuzione del job: 'NoneType' object is not iterable
2024-10-10 12:58:01,816 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-10 12:58:01,816 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-10 12:58:01,816 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-10 12:58:01,816 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

IF @GiornoDellaSettimana = 2 -- Se oggi è lunedì (2 in SQL Server rappresenta lunedì)
BEGIN
 SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,S.FieldName as JobStatusDesc,J.StartExecTimestamp
FROM 
    EMRLCBF1.[dbo].[JAPJobs] AS J 
INNER JOIN 
    EMRLCBF1.[dbo].[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN EMRLCBF1.dbo.Domains S ON S.TextValue=J.JobStatus
WHERE
 S.Field='JobStatus' and
    CAST(J.StartExecTimestamp AS DATE) =@Oggi
UNION ALL
 SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,S.FieldName as JobStatusDesc,J.StartExecTimestamp
FROM 
    EMRLCBF1.dbo.[JAPJobs] AS J 
INNER JOIN 
    EMRLCBF1.dbo.[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN EMRLCBF1.dbo.Domains S ON S.TextValue=J.JobStatus
WHERE
 S.Field='JobStatus' and    CAST(J.StartExecTimestamp AS DATE) =@Ieri AND J.JobStatus!='V'
UNION ALL
 SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,S.FieldName as JobStatusDesc,J.StartExecTimestamp
FROM 
    EMRLCBF1.dbo.[JAPJobs] AS J 
INNER JOIN 
    EMRLCBF1.dbo.[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN EMRLCBF1.dbo.Domains S ON S.TextValue=J.JobStatus
WHERE
 S.Field='JobStatus' and    CAST(J.StartExecTimestamp AS DATE) =@AltriIeri AND J.JobStatus!='V'
END
ELSE
BEGIN
 SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,S.FieldName as JobStatusDesc,J.StartExecTimestamp
FROM 
    EMRLCBF1.dbo.[JAPJobs] AS J 
INNER JOIN 
    EMRLCBF1.dbo.[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN EMRLCBF1.dbo.Domains S ON S.TextValue=J.JobStatus
WHERE
 S.Field='JobStatus' and 
    CAST(J.StartExecTimestamp AS DATE) =@Oggi
UNION ALL
 SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,S.FieldName as JobStatusDesc,J.StartExecTimestamp
FROM 
    EMRLCBF1.dbo.[JAPJobs] AS J 
INNER JOIN 
    EMRLCBF1.dbo.[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN EMRLCBF1.dbo.Domains S ON S.TextValue=J.JobStatus
WHERE
 S.Field='JobStatus' and    CAST(J.StartExecTimestamp AS DATE) =@Ieri  AND J.JobStatus!='V'
END
2024-10-10 12:58:01,901 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-10 12:58:01,973 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 3
2024-10-10 12:58:01,973 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-10 12:58:01,973 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-10 12:58:01,973 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-10 12:58:07,143 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-10-10 13:12:14,368 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-10 13:12:14,368 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-10 13:12:14,368 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-10 13:12:14,368 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

-- Creiamo una tabella temporanea per memorizzare i risultati
CREATE TABLE #Risultati (
    ProcessCode NVARCHAR(50),
    ProcessName NVARCHAR(100),
    JobStatus NVARCHAR(50),
    JobStatusDesc NVARCHAR(100),
    StartExecTimestamp NVARCHAR(20)
);

-- Inseriamo i dati per oggi (sempre)
INSERT INTO #Risultati
SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,
    S.FieldName as JobStatusDesc,
    CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
FROM 
    EMRLCBF1.[dbo].[JAPJobs] AS J 
INNER JOIN 
    EMRLCBF1.[dbo].[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN 
    EMRLCBF1.dbo.Domains S ON S.TextValue = J.JobStatus
WHERE
    S.Field = 'JobStatus' AND
    CAST(J.StartExecTimestamp AS DATE) = @Oggi;

-- Inseriamo i dati per ieri (sempre, ma con JobStatus != 'V')
INSERT INTO #Risultati
SELECT 
    P.ProcessCode,
    P.ProcessName,
    J.JobStatus,
    S.FieldName as JobStatusDesc,
    CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
FROM 
    EMRLCBF1.dbo.[JAPJobs] AS J 
INNER JOIN 
    EMRLCBF1.dbo.[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
INNER JOIN 
    EMRLCBF1.dbo.Domains S ON S.TextValue = J.JobStatus
WHERE
    S.Field = 'JobStatus' AND 
    CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
    J.JobStatus != 'V';

-- Se oggi è lunedì, inseriamo anche i dati per l'altro ieri
IF @GiornoDellaSettimana = 2
BEGIN
    INSERT INTO #Risultati
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J 
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V';
END

-- Selezioniamo e ordiniamo i risultati
SELECT * FROM #Risultati
ORDER BY ProcessName ASC, StartExecTimestamp DESC;

-- Puliamo la tabella temporanea
DROP TABLE #Risultati;
2024-10-10 13:12:14,447 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-10 13:12:14,526 - Job_ControlloJobsEmerald - ERROR - Errore durante l'esecuzione del job: 'NoneType' object is not iterable
2024-10-10 13:18:58,951 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-10 13:18:58,951 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-10 13:18:58,951 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-10 13:18:58,951 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-10-10 13:18:59,045 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-10 13:18:59,108 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 3
2024-10-10 13:18:59,108 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-10 13:18:59,108 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-10 13:18:59,108 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-10 13:19:04,324 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-10-10 13:21:29,210 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-10 13:21:29,210 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-10 13:21:29,210 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-10 13:21:29,210 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-10-10 13:21:29,289 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-10 13:21:29,320 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 3
2024-10-10 13:21:29,320 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-10 13:21:29,336 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-10 13:21:29,336 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-10 13:21:34,519 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-10-18 12:22:47,249 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-18 12:22:47,249 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-18 12:22:47,265 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-18 12:22:47,265 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-10-18 12:22:47,327 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-18 12:22:47,374 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 1
2024-10-18 12:22:47,374 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-18 12:22:52,561 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-10-24 11:21:18,033 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-24 11:21:18,033 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-24 11:21:18,064 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-24 11:21:18,064 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-10-24 11:21:18,142 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 19
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,330 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:21:18,502 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-10-24 11:52:34,921 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-24 11:52:34,921 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-24 11:52:34,921 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-24 11:52:34,921 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-10-24 11:52:34,999 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 19
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,187 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-24 11:52:35,374 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-10-25 09:35:54,221 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-25 09:35:54,221 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-25 09:35:54,252 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-25 09:35:54,252 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-10-25 09:35:54,330 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 22
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,533 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-25 09:35:54,721 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-10-28 09:58:15,442 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-28 09:58:15,443 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-28 09:58:15,460 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-28 09:58:15,460 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-10-28 09:58:15,556 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-28 09:58:15,731 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 13
2024-10-28 09:58:15,737 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,738 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,738 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,739 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,739 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,739 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,740 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,740 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,740 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,741 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,741 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,741 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,742 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-28 09:58:15,953 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-10-29 09:33:13,107 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-29 09:33:13,107 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-29 09:33:13,107 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-29 09:33:13,107 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-10-29 09:33:13,201 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 23
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,451 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,467 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-29 09:33:13,685 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-10-30 11:55:47,974 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-30 11:55:47,974 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-30 11:55:47,990 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-30 11:55:47,990 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-10-30 11:55:48,068 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 20
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,271 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-30 11:55:48,458 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-10-31 12:10:09,548 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-10-31 12:10:09,548 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-10-31 12:10:09,568 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-10-31 12:10:09,568 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-10-31 12:10:09,638 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-10-31 12:10:09,865 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 21
2024-10-31 12:10:09,871 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,872 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,872 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,872 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,873 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,873 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,874 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,874 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,874 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,875 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,875 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,875 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,876 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,876 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,876 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,877 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,877 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,877 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,878 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,878 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:09,878 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-10-31 12:10:10,065 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-04 11:08:31,615 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-04 11:08:31,615 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-04 11:08:31,630 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-04 11:08:31,630 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-04 11:08:31,693 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 51
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,162 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-04 11:08:32,365 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-05 10:08:40,386 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-05 10:08:40,386 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-05 10:08:40,386 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-05 10:08:40,386 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-05 10:08:40,464 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 26
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,698 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,714 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-05 10:08:40,901 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-06 14:51:33,678 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-06 14:51:33,678 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-06 14:51:33,694 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-06 14:51:33,694 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-06 14:51:33,772 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-06 14:51:34,069 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 34
2024-11-06 14:51:34,069 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,069 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,069 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,069 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,069 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,069 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,069 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,085 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-06 14:51:34,272 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-07 10:37:20,186 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-07 10:37:20,186 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-07 10:37:20,186 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-07 10:37:20,186 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-07 10:37:20,264 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-07 10:37:20,498 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 22
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,514 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-07 10:37:20,686 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-08 11:47:36,157 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-08 11:47:36,157 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-08 11:47:36,188 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-08 11:47:36,188 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-08 11:47:36,298 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 29
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,563 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,579 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-08 11:47:36,735 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-11 10:14:22,612 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-11 10:14:22,612 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-11 10:14:22,628 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-11 10:14:22,628 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-11 10:14:22,706 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 20
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:22,893 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-11 10:14:23,065 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-12 11:13:05,458 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-12 11:13:05,458 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-12 11:13:05,473 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-12 11:13:05,473 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-12 11:13:05,567 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-12 11:13:05,817 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 31
2024-11-12 11:13:05,817 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,817 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,817 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,817 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:05,833 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:13:06,005 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-12 11:14:12,783 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-12 11:14:12,783 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-12 11:14:12,783 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-12 11:14:12,783 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-12 11:14:12,846 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-12 11:14:13,112 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 31
2024-11-12 11:14:13,112 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,112 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,112 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,127 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-12 11:14:13,268 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-13 09:28:19,481 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-13 09:28:19,481 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-13 09:28:19,481 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-13 09:28:19,481 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-13 09:28:19,559 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 17
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,731 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,746 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,746 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,746 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,746 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,746 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-13 09:28:19,934 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-14 14:19:41,320 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-14 14:19:41,320 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-14 14:19:41,336 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-14 14:19:41,336 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-14 14:19:41,414 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 29
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,695 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,711 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,711 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,711 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,711 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,711 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,711 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-14 14:19:41,914 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-15 09:28:58,675 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-15 09:28:58,675 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-15 09:28:58,675 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-15 09:28:58,675 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-15 09:28:58,784 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 18
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,956 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,972 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,972 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,972 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,972 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:58,972 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-15 09:28:59,159 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-18 10:00:47,241 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-18 10:00:47,241 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-18 10:00:47,257 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-18 10:00:47,257 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-18 10:00:47,335 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-18 10:00:47,476 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 11
2024-11-18 10:00:47,476 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,476 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,491 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,491 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,491 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,491 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,491 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,491 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,491 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,491 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,491 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-18 10:00:47,679 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-19 10:00:45,939 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-19 10:00:45,939 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-19 10:00:45,955 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-19 10:00:45,955 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-19 10:00:46,049 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 24
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,424 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-19 10:00:46,612 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-20 10:00:43,494 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-20 10:00:43,494 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-20 10:00:43,510 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-20 10:00:43,510 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-20 10:00:43,588 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 21
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,791 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,806 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,806 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,806 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-20 10:00:43,963 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-21 10:00:43,659 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-21 10:00:43,659 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-21 10:00:43,674 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-21 10:00:43,674 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-21 10:00:43,753 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-21 10:00:43,971 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 23
2024-11-21 10:00:43,971 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,971 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,971 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,971 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,971 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,971 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,971 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:43,987 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-21 10:00:44,190 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-22 10:00:45,617 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-22 10:00:45,633 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-22 10:00:45,649 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-22 10:00:45,649 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-22 10:00:45,727 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 21
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:45,946 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-22 10:00:46,133 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-23 10:00:20,451 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-23 10:00:20,451 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-23 10:00:20,467 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-23 10:00:20,467 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-23 10:00:20,561 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-23 10:00:20,779 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 17
2024-11-23 10:00:20,779 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,779 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,779 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,795 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-23 10:00:20,999 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-25 10:00:49,323 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-25 10:00:49,323 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-25 10:00:49,339 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-25 10:00:49,339 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-25 10:00:49,432 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 12
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,573 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-25 10:00:49,776 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-26 10:00:47,546 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-26 10:00:47,546 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-26 10:00:47,562 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-26 10:00:47,562 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-26 10:00:47,671 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 23
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,937 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,953 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,953 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,953 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:47,953 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-26 10:00:48,140 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-27 10:00:46,036 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-27 10:00:46,036 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-27 10:00:46,051 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-27 10:00:46,051 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-27 10:00:46,129 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 18
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,301 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-27 10:00:46,473 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-28 10:00:50,877 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-28 10:00:50,877 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-28 10:00:50,908 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-28 10:00:50,908 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-28 10:00:51,001 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 17
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,189 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,205 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,205 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,205 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,205 - Job_ControlloJobsEmerald - INFO - Valore di condizione1: JobStatus != 'V'
2024-11-28 10:00:51,392 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-28 16:49:36,821 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-28 16:49:36,821 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-28 16:49:36,837 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-28 16:49:36,837 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-28 16:49:36,915 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-28 16:49:36,978 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 0
2024-11-28 16:49:36,978 - Job_ControlloJobsEmerald - INFO - La query non ha restituito righe, invio email senza risultati.
2024-11-28 16:49:42,168 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-28 16:55:33,788 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-28 16:55:33,788 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-28 16:55:33,788 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-28 16:55:33,788 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-28 16:55:33,867 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-28 16:55:33,893 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 0
2024-11-28 16:55:33,893 - Job_ControlloJobsEmerald - INFO - La query non ha restituito righe, invio email senza risultati.
2024-11-28 16:55:39,088 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-11-29 13:32:50,989 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-11-29 13:32:50,989 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-11-29 13:32:50,993 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-11-29 13:32:50,993 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-11-29 13:32:51,102 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-11-29 13:32:51,118 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 0
2024-11-29 13:32:51,118 - Job_ControlloJobsEmerald - INFO - La query non ha restituito righe, invio email senza risultati.
2024-11-29 13:32:56,371 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-12-05 09:25:09,265 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-12-05 09:25:09,265 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-12-05 09:25:09,297 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-12-05 09:25:09,297 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-12-05 09:25:09,359 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-12-05 09:25:09,406 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 0
2024-12-05 09:25:09,422 - Job_ControlloJobsEmerald - INFO - La query non ha restituito righe, invio email senza risultati.
2024-12-05 09:25:14,594 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-12-05 09:30:44,324 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-12-05 09:30:44,324 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-12-05 09:30:44,324 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-12-05 09:30:44,324 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-12-05 09:30:44,418 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-12-05 09:30:44,433 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 0
2024-12-05 09:30:44,433 - Job_ControlloJobsEmerald - INFO - La query non ha restituito righe, invio email senza risultati.
2024-12-05 09:30:49,621 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-12-05 09:45:26,535 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-12-05 09:45:26,535 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-12-05 09:45:26,535 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-12-05 09:45:26,535 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-12-05 09:45:26,613 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-12-05 09:45:26,629 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 0
2024-12-05 09:45:26,629 - Job_ControlloJobsEmerald - INFO - La query non ha restituito righe, invio email senza risultati.
2024-12-05 09:45:31,833 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-12-05 09:53:48,409 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-12-05 09:53:48,409 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-12-05 09:53:48,409 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-12-05 09:53:48,409 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-12-05 09:53:48,487 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-12-05 09:53:48,502 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 0
2024-12-05 09:53:48,502 - Job_ControlloJobsEmerald - INFO - La query non ha restituito righe, invio email senza risultati.
2024-12-05 09:53:53,721 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
2024-12-11 15:11:58,991 - Job_ControlloJobsEmerald - INFO - Esecuzione del job: ControlloJobsEmerald
2024-12-11 15:11:58,991 - Job_ControlloJobsEmerald - INFO - Reading query from: D:\SPA\Python\EMERALD\ControlloJobsEmerald\QueryControlloJobsEmerald.sql
2024-12-11 15:11:58,991 - Job_ControlloJobsEmerald - INFO - Query read successfully
2024-12-11 15:11:58,991 - Job_ControlloJobsEmerald - INFO - Query da eseguire: DECLARE @Oggi DATE = CAST(GETDATE() AS DATE);
DECLARE @Ieri DATE = DATEADD(DAY, -1, @Oggi);
DECLARE @AltriIeri DATE = DATEADD(DAY, -2, @Oggi);
DECLARE @GiornoDellaSettimana INT = DATEPART(WEEKDAY, @Oggi);

SELECT * FROM (
    -- Dati per oggi (sempre)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.[dbo].[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.[dbo].[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND
        CAST(J.StartExecTimestamp AS DATE) = @Oggi

    UNION ALL

    -- Dati per ieri (sempre, ma con JobStatus != 'V')
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @Ieri AND 
        J.JobStatus != 'V'

    UNION ALL

    -- Dati per l'altro ieri (solo se oggi è lunedì)
    SELECT 
        P.ProcessCode,
        P.ProcessName,
        J.JobStatus,
        S.FieldName as JobStatusDesc,
        CONVERT(VARCHAR, J.StartExecTimestamp, 103) + ' ' + CONVERT(VARCHAR, J.StartExecTimestamp, 108) as StartExecTimestamp
    FROM 
        EMRLCBF1.dbo.[JAPJobs] AS J WITH (NOLOCK)
    INNER JOIN 
        EMRLCBF1.dbo.[JAPProcesses] P WITH (NOLOCK) ON J.ProcessCode = P.ProcessCode
    INNER JOIN 
        EMRLCBF1.dbo.Domains S WITH (NOLOCK) ON S.TextValue = J.JobStatus
    WHERE
        S.Field = 'JobStatus' AND 
        CAST(J.StartExecTimestamp AS DATE) = @AltriIeri AND 
        J.JobStatus != 'V' AND
        @GiornoDellaSettimana = 2  -- Questo assicura che questi dati vengano inclusi solo se oggi è lunedì
) AS ResultSet
ORDER BY ProcessName ASC, StartExecTimestamp DESC;
2024-12-11 15:11:59,053 - Job_ControlloJobsEmerald - INFO - Connessione al database stabilita con successo.
2024-12-11 15:11:59,131 - Job_ControlloJobsEmerald - INFO - Query eseguita con successo. Righe recuperate: 0
2024-12-11 15:11:59,131 - Job_ControlloJobsEmerald - INFO - La query non ha restituito righe, invio email senza risultati.
2024-12-11 15:12:04,335 - Job_ControlloJobsEmerald - INFO - Email con corpo HTML inviata con successo.
